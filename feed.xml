<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Enrico Teotti - developer and agile mentor with over 15 years experience in the IT industry</title>
    <description>developer and agile mentor with over 15 years of experience in the IT industry across Europe, Australia and the US.
</description>
    <link>http://teotti.com/</link>
    <atom:link href="http://teotti.com/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Mon, 07 Oct 2019 16:29:26 +0000</pubDate>
    <lastBuildDate>Mon, 07 Oct 2019 16:29:26 +0000</lastBuildDate>
    <generator>Jekyll v2.4.0</generator>
    
      <item>
        <title>Remote visual facilitation with iPad pro</title>
        <description>&lt;p&gt;In this brif post I explain how I do visual facilitation and visual recording with an iPad, Mac Book and Zoom. You can probably use a PC instead of a Mac Book but I haven’t tried.&lt;/p&gt;

&lt;h2 id=&quot;ipad-screen-sharing&quot;&gt;iPad screen sharing&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;Connect the iPad with a USB cable to the Mac Book pro&lt;/li&gt;
  &lt;li&gt;Make sure you accept whatever prompt about trusting computer etc.&lt;/li&gt;
  &lt;li&gt;Open quicktime and select “New Movie Recording”, choose iPad from the drop down. If you don’t see iPad listed the connection failed and you’ll have to truble shoot that first. In my experience unplugging and re-connecting the USB cable helps.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;At this point you are “seeing” what’s on the iPad from your Mac Book. Open your visual facilitation app of choice and confirm its as responsive as you would like. &lt;/p&gt;

&lt;p&gt;I use Zoom to screen share with remote participants. If you know of other tools that allow for multiple screen sharing leave  a comment.&lt;/p&gt;

&lt;h2 id=&quot;zoom&quot;&gt;Zoom&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;open the Zoom settings and update to use dual monitors &lt;img src=&quot;http://teotti.com/assets/article_images/remote-visual-facilitation-with-ipad-pro/step1.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Once you start your meeting ensure your meeting sharing option is set to the correct option: “Multiple participant can share simultaneously” &lt;img src=&quot;http://teotti.com/assets/article_images/remote-visual-facilitation-with-ipad-pro/step2.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;At this point multiple participants can share their screen, here I am using it with two folks &lt;img src=&quot;http://teotti.com/assets/article_images/remote-visual-facilitation-with-ipad-pro/hero.jpg&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;conclusions&quot;&gt;Conclusions&lt;/h2&gt;

&lt;p&gt;This solution is working for me today when I do visual recording–aka scribing–and lead remote visual facilitation for meetings.&lt;/p&gt;

&lt;p&gt;One downside in the latter is participants can’t interact with your whiteboard. I use an interactive online tool–like Miro aka RealTimeBoard–to promote and allow participation, potentially you could export the note to your online board when you need to be more interactive.&lt;/p&gt;

&lt;p&gt;Leave us a comment if you have a similar strategy and different tools.&lt;/p&gt;
</description>
        <pubDate>Mon, 07 Oct 2019 00:00:00 +0000</pubDate>
        <link>http://teotti.com/remote-visual-facilitation-with-ipad-pro/</link>
        <guid isPermaLink="true">http://teotti.com/remote-visual-facilitation-with-ipad-pro/</guid>
        
        <category>process</category>
        
        
      </item>
    
      <item>
        <title>Challenge Kerth&#39;s prime directive when you set the stage of your retro</title>
        <description>&lt;p&gt;This post assumes you know what a retrospective is and focuses on an activity to set the stage challenging what Kert’s prime directive means to the group.&lt;/p&gt;

&lt;p&gt;This is an 80% muted–no talking–activity to use at the start of your retro. It should last between 5 to 10 minutes.&lt;/p&gt;

&lt;p&gt;Often the facilitator asks the group for a verbal yes to agree with Kerth’s prime directive. Most people can see its value but sometime you get a “&lt;em&gt;yeaahh sure I agree… they did the best job they could&lt;/em&gt;” but what that person really thinks is “&lt;strong&gt;they did a really stinky job&lt;/strong&gt;”.&lt;/p&gt;

&lt;p&gt;Sometime people think that about themselves.&lt;/p&gt;

&lt;h3 id=&quot;when-to-use-the-activity&quot;&gt;When to use the activity&lt;/h3&gt;

&lt;p&gt;I’d use this activity on groups new to Kerth’s prime directive or groups where an individual dismissed the directive.&lt;/p&gt;

&lt;p&gt;The objective is to give time to the group to better understand the meaning of the sentence.&lt;/p&gt;

&lt;p&gt;Before using this activity &lt;a href=&quot;/analyze-kerth-prime-directive/&quot;&gt;make sure you fully understand the directive yourself&lt;/a&gt; or it will be challenging to deal with questions from your group.&lt;/p&gt;

&lt;h2 id=&quot;activity-introduction&quot;&gt;Activity introduction&lt;/h2&gt;

&lt;p&gt;The facilitator reads the prime directive and explains that by accepting it the group will make retrospective a more constructive and effective environment.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Regardless of what we discover, we must understand and truly believe that everyone did the best job he or she could given what was known at the time, his or her skills and abilities, the resources available, and the situation at hand.&lt;/p&gt;

  &lt;p&gt;Norm Kerth prime directive&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;Instead of asking the group for the directive acceptance with a verbal yes tell them we will spend a few minutes questioning the directive.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Give the group a minute or two to remember an episode in their previous job where they believe the prime directive could not be applied. Read the directive highlighting the &lt;strong&gt;givens&lt;/strong&gt; portion:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;given what was known at the time&lt;/li&gt;
  &lt;li&gt;given his or her skills and abilities&lt;/li&gt;
  &lt;li&gt;given the resources available&lt;/li&gt;
  &lt;li&gt;given the situation at hand&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;After&lt;/strong&gt; the two minutes of thinking back–or less–ask them to summarize the episode on a post-it note. If people believe in the directive you can ask to summarize an episode where the directive was applicable.&lt;/p&gt;

&lt;p&gt;Once done writing ask them to reflect on the &lt;strong&gt;factors&lt;/strong&gt; that might have affected that episode:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;what was known at the time of the episode/incident&lt;/li&gt;
  &lt;li&gt;what were that person’s–or group–skills and abilities&lt;/li&gt;
  &lt;li&gt;what resources–time, team size, bandwidth–were available&lt;/li&gt;
  &lt;li&gt;what was the situation at hand&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Reflecting about these factors will help us gain a better understanding of the events we look during retrospective.&lt;/p&gt;

&lt;h2 id=&quot;activity-debriefing&quot;&gt;Activity debriefing&lt;/h2&gt;

&lt;p&gt;After reflecting on how these factors impacted the job done ask if they still think the best job wasn’t done given these &lt;strong&gt;factors&lt;/strong&gt; or if perhaps they don’t know how to answer about these &lt;strong&gt;factors&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Now is the time to ask each participants if they accept the prime directive for today’s retrospective.&lt;/p&gt;

&lt;h3 id=&quot;skeptics-in-the-group&quot;&gt;Skeptics in the group&lt;/h3&gt;

&lt;p&gt;Remind the group that it’s ok to still think the directive doesn’t apply to their episode.&lt;/p&gt;

&lt;p&gt;Ask if they are ok sharing the episode with the group and try to understand the factors. Also acknowledge that sometimes there are extreme situations where individuals might purposely sabotaging projects and use an unprofessional conduct.&lt;/p&gt;

&lt;p&gt;Ask them if they are ok &lt;strong&gt;putting aside their biases and accept the directive for the duration of today’s retrospective&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;If they accept thank them. If they still refuse–even just for today’s retro–there must be a deeper issue that needs to be tackled.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;If it’s an individual I’d say continue the retrospective and keep an eye on his/her behavior and follow-up one-on-one afterwards&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;If the majority of the group feels that way it’s better to call the retrospective off and investigate further on the root cause of that tension.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;Retrospectives are the most important part of an iteration and changing their format is imperative to keep people engaged.&lt;/p&gt;

&lt;p&gt;If people understand Kerth’s prime directive printing it out and reminding people about it is usually enough.&lt;/p&gt;

&lt;p&gt;When people are new to Kerth’s prime directive it’s good to explain it and challenge it instead of getting a–often disengaged–verbal yes.&lt;/p&gt;

&lt;p&gt;Before trying this activity &lt;a href=&quot;/analyze-kerth-prime-directive/&quot;&gt;make sure you fully understand the directive&lt;/a&gt; there is another great post about &lt;a href=&quot;https://www.infoq.com/articles/retrospective-prime-directive&quot;&gt;questioning the directive&lt;/a&gt; with input from though leaders in the retrospective community.&lt;/p&gt;
</description>
        <pubDate>Sat, 21 Jul 2018 00:00:00 +0000</pubDate>
        <link>http://teotti.com/challenge-agile-retrospectives-prime-directive/</link>
        <guid isPermaLink="true">http://teotti.com/challenge-agile-retrospectives-prime-directive/</guid>
        
        <category>retrospectives</category>
        
        <category>process</category>
        
        <category>agile</category>
        
        
      </item>
    
      <item>
        <title>Analyze Kerth prime directive</title>
        <description>&lt;p&gt;This post assumes you know what a retrospective is and focuses on Kerth’s prime directive to ensure the facilitator can answer common challenges around the directive and confidently explain it to the group.&lt;/p&gt;

&lt;p&gt;Weeks ago I gave a public presentation about retrospectives and &lt;a href=&quot;https://www.youtube.com/watch?v=0hatxoP-MU0&amp;amp;t=7m00s&quot;&gt;after introducing Kerth’s directive&lt;/a&gt; a person in the audience shouted to me “that is a lie!”. Btw that link is the same presentation but different audience so no shouting.&lt;/p&gt;

&lt;p&gt;In order to create a constructive session Kerth’s prime directive is usually read–and agreed upon–at the beginning of a retrospective:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Regardless of what we discover, we must understand and truly believe that everyone did the best job he or she could given what was known at the time, his or her skills and abilities, the resources available, and the situation at hand.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;I tried to ask what in the directive was bothering that person but he mostly vented how some people can only do a poor job.&lt;/p&gt;

&lt;p&gt;The directive sends a strong message that is often misunderstood. I might have not explained it very well so I decided to write down my thoughts in this blog post.&lt;/p&gt;

&lt;h2 id=&quot;dissecting-the-directive&quot;&gt;Dissecting the directive&lt;/h2&gt;

&lt;p&gt;The first part of the prime directive states that:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Regardless of what we discover, we must understand and truly believe that everyone did the best job he or she could&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;which leads to misunderstandings &lt;strong&gt;without reflecting on the second part of the directive&lt;/strong&gt;: &lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;given what was known at the time, his or her skills and abilities, the resources available, and the situation at hand.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The prime directive doesn’t pardon negligent acts–more on this point later–it gently reminds us that there are &lt;strong&gt;factors&lt;/strong&gt; to provide context on why &lt;strong&gt;the best job that someone did&lt;/strong&gt; might look so poor in retrospect.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Accepting the directive means we are willing to focus the retrospective on those factors instead of playing a quick and easy blame game.&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;given-what-was-known-at-the-time&quot;&gt;Given what was known at the time&lt;/h3&gt;

&lt;p&gt;Of course today–&lt;em&gt;after&lt;/em&gt; the event happened–we probably already know more then back then or maybe decisions were made based on lack of context! &lt;strong&gt;“Was the new testing URL shared with all developers with enough time? Even the new hires from last week?”&lt;/strong&gt;&lt;/p&gt;

&lt;h3 id=&quot;given-his-or-her-skills-and-abilities&quot;&gt;Given his or her skills and abilities&lt;/h3&gt;

&lt;p&gt;Maybe the refactor triggered a runtime error–crashing the production app–because the person joined last week and had no prior experience with the backend language or didn’t know how to run our test framework.&lt;/p&gt;

&lt;h3 id=&quot;given-the-resources-available&quot;&gt;Given the resources available&lt;/h3&gt;

&lt;p&gt;Perhaps the developer was &lt;strong&gt;rushed to deploy the change in 30 minutes&lt;/strong&gt; before the all-hands status meeting.&lt;/p&gt;

&lt;h3 id=&quot;given-the-situation-at-hand&quot;&gt;Given the situation at hand&lt;/h3&gt;

&lt;p&gt;Perhaps that &lt;strong&gt;part of changed code was a knowledge silo owned by another developer that quit the day before&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;it-must-be-someones-fault&quot;&gt;It must be someone’s fault&lt;/h2&gt;

&lt;p&gt;If a developer brings a production API down was that the best job he could do? He’s probably aware of his mistake and ready to take the blame. But what good does finding a culprit bring us if we don’t learn the circumstances and look for a root cause?&lt;/p&gt;

&lt;p&gt;Maybe it was the best job he could do &lt;strong&gt;given what he knew at that time&lt;/strong&gt; if for example he didn’t have any context on what API he was about to turn off! &lt;strong&gt;Perhaps no one was awake to tell him that deployxyz.myapp.com was switched to be the production API URL during this morning 4am hotfix&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;promoting-incompetence&quot;&gt;Promoting incompetence?&lt;/h2&gt;

&lt;p&gt;The prime directive doesn’t mean there isn’t accountability. It simply tells us to stop looking for blame and accept that there are factors we need to gather a fuller picture.&lt;/p&gt;

&lt;p&gt;If when you have the full picture some actions are proven to be grave work misconducts they should be addressed by HR outside of a retrospective.&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;I think the first time Kerth’s prime directive is introduced to a team it deserves to be dissected, questioned and explained rather then just read and asked for agreement. If you don’t you risk people resenting it because they will accept it without fully understanding it. &lt;/p&gt;

&lt;p&gt;Hopefully this article will help retrospective facilitators to better understand Kerth’s prime directive and engage in constructive conversations with their group. I am writing a post about an activity to set the stage to challenge the prime directive to help with this.&lt;/p&gt;

&lt;p&gt;Is the prime directive a lie? I don’t think so.&lt;/p&gt;

&lt;p&gt;Is it a philosophical mind trick? I don’t know.&lt;/p&gt;

&lt;p&gt;Does it help starting retrospectives in a positive environment and focus on learning instead of playing the blame game? Yes.&lt;/p&gt;

&lt;p&gt;I accept it. Do you?&lt;/p&gt;
</description>
        <pubDate>Tue, 10 Jul 2018 00:00:00 +0000</pubDate>
        <link>http://teotti.com/analyze-kerth-prime-directive/</link>
        <guid isPermaLink="true">http://teotti.com/analyze-kerth-prime-directive/</guid>
        
        <category>retrospectives</category>
        
        <category>process</category>
        
        <category>agile</category>
        
        
      </item>
    
      <item>
        <title>Measure success of your agile retrospective</title>
        <description>&lt;p&gt;Retrospectives should be a core practice for any team but &lt;strong&gt;you must have a way to measure their success and team engagement otherwise they can become just another meeting&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;The retrospective should generate a quantitatively measurable experiment/action item and the team engagement metrics will generate qualitative measurements.&lt;/p&gt;

&lt;p&gt;In this article I’ll explain why they’re both critical to retrospective success. Folks that have been in retrospectives and wondered “what’s the point of this meeting?” should get a better understanding of their purpose and facilitators/scrum masters will learn when/how to measure retrospective engagement and success metrics.&lt;/p&gt;

&lt;h3 id=&quot;preamble&quot;&gt;Preamble&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;You retrospective must be a safe environment or people won’t speak their mind&lt;/strong&gt;. I gave a 20 minutes talk at the Sydney Pivotal office about &lt;a href=&quot;https://www.youtube.com/watch?v=0hatxoP-MU0&quot;&gt;How to measure retrospective success&lt;/a&gt; and I share ideas to check your retrospective safety and how to improve it. If you’re interested in retrospectives I gave a talk about &lt;a href=&quot;https://www.youtube.com/watch?v=-Pw-p6DzvFQ&quot;&gt;switching retrospective formats&lt;/a&gt; loosely based on my &lt;a href=&quot;http://teotti.com/change-your-agile-retrospective-format/&quot;&gt;blog post&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;why-we-run-retrospectives&quot;&gt;Why we run retrospectives?&lt;/h2&gt;

&lt;p&gt;The right mindset for a retrospective requires the team to understand and agree that today &lt;strong&gt;we know more then we did last week&lt;/strong&gt;. I think Kerth’s prime directive captures that:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;p&gt;Regardless of what we discover, we understand and truly believe that everyone did the best job they could, given what they knew at the time, their skills and abilities, the resources available, and the situation at hand.&lt;/p&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;p&gt;I think the agile manifesto captures the spirit of why we run retrospectives:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;p&gt;At regular intervals, the team reflects on how to become more effective, then tunes and adjusts its behavior accordingly. &lt;/p&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;p&gt;You want to run retrospectives &lt;strong&gt;at regular intervals&lt;/strong&gt; because doing it “when we need it” is like seeking urgent dental care after you pop a decade old filling–and half your tooth–instead of preventing that with regular checkups. Regular intervals will allow you to measure how the team feel about retrospective–more on this later.&lt;/p&gt;

&lt;p&gt;You want the team to &lt;strong&gt;reflect on how to become more effective&lt;/strong&gt; because acting on individual issues might fix the symptoms instead of the root cause. Reflect on hard data and feelings then look for patterns, generate insights. Take time to reflect and don’t rush to find a solution for each item that comes up like if you were playing a whack a mole game.&lt;/p&gt;

&lt;p&gt;You want the team to commit to &lt;strong&gt;tune and adjust its behavior&lt;/strong&gt; with an agreed and quantitatively measurable experiment. &lt;/p&gt;

&lt;h2 id=&quot;measure-your-retrospective-success&quot;&gt;Measure your retrospective success&lt;/h2&gt;

&lt;p&gt;I like to use the S.M.A.R.T. experiment–SMART is a simple acronym to remind us to come up with an experiment that is:&lt;/p&gt;

&lt;h3 id=&quot;specific&quot;&gt;Specific:&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt;We should pair program more&lt;/strong&gt;&lt;/em&gt; isn’t very specific. Instead use: &lt;strong&gt;Pair program everyday 4 hours per day&lt;/strong&gt;.&lt;/p&gt;

&lt;h3 id=&quot;measurable&quot;&gt;Measurable:&lt;/h3&gt;

&lt;p&gt;You can measure how many times you &lt;strong&gt;Pair program 4 hours per day&lt;/strong&gt;. You should also measure hard data like velocity, delivered stories, bugs.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;blockquote&gt;
      &lt;p&gt;This measurement should be quantitative and related to how effective your team is. &lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;achievable&quot;&gt;Achievable:&lt;/h3&gt;

&lt;p&gt;Use an experiment that generate consensus with the team. It won’t be a good idea to come up with &lt;strong&gt;Pair program everyday 8 hours per day&lt;/strong&gt; when you know people are skeptic about it. Find a more suitable experiment, maybe &lt;strong&gt;Pair program 2 days per week&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Use an experiment that makes the team step out of their comfort zone without attempting to fix things clearly out of reach. &lt;/p&gt;

&lt;h3 id=&quot;relevant&quot;&gt;Relevant:&lt;/h3&gt;

&lt;p&gt;Why do you want to pair program? Because someone told you so? Not very relevant or meaningful.&lt;/p&gt;

&lt;p&gt;Perhaps someone called out that &lt;em&gt;Jack was sick 4 days and we could not work on the iOS react native UI components&lt;/em&gt; and also &lt;em&gt;designers are not available to clarify how user interface should work&lt;/em&gt; so you might &lt;strong&gt;want to break knowledge silos that block team progress&lt;/strong&gt;. That’s one great use of pair programming!&lt;/p&gt;

&lt;h3 id=&quot;timebound&quot;&gt;Timebound:&lt;/h3&gt;

&lt;p&gt;Do not use an open ended experiment. Make sure there is an end to it like &lt;strong&gt;we will try pair programming for 2 weeks&lt;/strong&gt; and then decide to continue or adjust the experiment. Having a timebound experiment should create common ground between optimists and skeptics and facilitate trying new things.&lt;/p&gt;

&lt;p&gt;Here’s our measurable SMART experiment:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;p&gt;We want to break knowledge silos that often block our team progress. In order to do that developers will pair program 4 hours a day for the next 2 weeks. Designers will pair program 1hour a day with developers to clarify and learn app internal behavior We will keep track of how many times we do that on the pair programming sheet on our shared workspace. In 2 weeks we will review this experiment and decide if we want to continue or adjust it.&lt;/p&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;p&gt;I started the article explaining how to measure your retrospective success to address the quantitative measurement first but the experiment is formulated in the middle of the retrospective. When you start your retrospective you should get a qualitative measurement on team engagement.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;measure-team-engagement-esvp&quot;&gt;Measure team engagement (ESVP)&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/measure-success-of-your-agile-retrospective/esvp.png&quot; alt=&quot;&quot; class=&quot;center-image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;When you start retrospective&lt;/strong&gt; you should spend 5/10 minutes measuring the team engagement. Depending on how safe it is you can make it anonymous or not.&lt;/p&gt;

&lt;p&gt;I like to do that using an activity–from Derby and Larsen’s &lt;a href=&quot;https://www.amazon.com/Agile-Retrospectives-Making-Teams-Great/dp/0977616649&quot;&gt;book&lt;/a&gt;–called ESVP. You ask the team which role between &lt;strong&gt;Explorer, Shopper, Vacationer, Prisoner&lt;/strong&gt; represents best how they feel about today’s retrospective:&lt;/p&gt;

&lt;h3 id=&quot;explorers&quot;&gt;Explorers&lt;/h3&gt;

&lt;p&gt;They want to make the most out of today’s retrospective. Learn everything they can about the iteration/project, leave no stone unturned.&lt;/p&gt;

&lt;h3 id=&quot;shoppers&quot;&gt;Shoppers&lt;/h3&gt;

&lt;p&gt;They’re happy to be part of the retrospective and want to actively look for something to put in their cart.&lt;/p&gt;

&lt;h3 id=&quot;vacationers&quot;&gt;Vacationers&lt;/h3&gt;

&lt;p&gt;They’re not interested in retrospective but they rather be in it then doing actual work at their desk.&lt;/p&gt;

&lt;h3 id=&quot;prisoners&quot;&gt;Prisoners&lt;/h3&gt;

&lt;p&gt;They’ve been forced to sit in this meeting but don’t see a point in it and won’t be actively participating.&lt;/p&gt;

&lt;p&gt;Collecting these at regular intervals will allow you to learn when the team is shifting from engaged to disengaged and adjust your retrospective accordingly.&lt;/p&gt;

&lt;p&gt;It will also allow you to celebrate when the team shifts the other way around! Learn what you’re doing well and try do more of it or &lt;strong&gt;share it with other teams in your organization&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/measure-success-of-your-agile-retrospective/esvp_graph.png&quot; alt=&quot;print the weekly figures on a graph on your shared space&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;measure-the-return-of-time-invested-roti&quot;&gt;Measure the return of time invested (ROTI)&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;Before you finish retrospective&lt;/strong&gt; you should spend 5/10 minutes measuring how well we spent the allocated time. I usually ask the team how was the return of time invested for this meeting between 0 and 4 where&lt;/p&gt;

&lt;h3 id=&quot;excellent&quot;&gt;4: Excellent&lt;/h3&gt;

&lt;p&gt;Means this meeting was invaluable and if you skipped it you would have missed some key piece of information. You’re very glad you were in it.&lt;/p&gt;

&lt;h3 id=&quot;above-average&quot;&gt;3: Above average&lt;/h3&gt;

&lt;p&gt;This meeting was a good use of your time you learned new things.&lt;/p&gt;

&lt;h3 id=&quot;average&quot;&gt;2: Average&lt;/h3&gt;

&lt;p&gt;This meeting gave you enough to justify your presence for the time spent on it.&lt;/p&gt;

&lt;h3 id=&quot;below-average&quot;&gt;1: Below average&lt;/h3&gt;

&lt;p&gt;You gained some value but it was mostly a waste of time. This meeting was below average and wasn’t worth 100% of your time.&lt;/p&gt;

&lt;h3 id=&quot;useless&quot;&gt;0: Useless&lt;/h3&gt;

&lt;p&gt;This meeting was a waste of time. You gained nothing and wished you skipped it.&lt;/p&gt;

&lt;p&gt;After they choose a number ask one suggestion/idea to improve by one point. The retrospective is coming to an end so tell the team we won’t engage in long discussions about those ideas but rather collect them and review them to adjust our next retro. Timebox each person to 60 seconds.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/measure-success-of-your-agile-retrospective/roti_graph.png&quot; alt=&quot;print the weekly figures on a graph on your shared space&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;Making your team more effective doesn’t need to tackle huge issues all the time. What is critical is to measure and review the experiment progress at regular intervals so the team can trust retrospective to be a meaningful tool to adjust their process.&lt;/p&gt;

&lt;p&gt;Keep a constant eye on how the team feels about retro because failing to do so might generate a room full of disengaged prisoners that believe they’re wasting their time making your experiment not achievable.&lt;/p&gt;

&lt;p&gt;Are you going to try some of the suggested strategies? Do you already measure your retrospectives? What challenges do you face?&lt;/p&gt;
</description>
        <pubDate>Fri, 01 Jun 2018 00:00:00 +0000</pubDate>
        <link>http://teotti.com/measure-success-of-your-agile-retrospective/</link>
        <guid isPermaLink="true">http://teotti.com/measure-success-of-your-agile-retrospective/</guid>
        
        <category>workflow</category>
        
        <category>agile</category>
        
        <category>retrospectives</category>
        
        
      </item>
    
      <item>
        <title>Time to change your agile retrospective format?</title>
        <description>&lt;p&gt;In this article–targeted to retrospective facilitators–I describe my experience going from a simple retrospective format to a more structured one following Derby and Larsen’s book on Agile Retrospectives.&lt;/p&gt;

&lt;p&gt;I’ve seen the first format working for teams of 2/3 developers new to retrospectives but it was ineffective for larger teams on challenging projects–it ended up feeling like a status update meeting–so I introduced to the second format. &lt;/p&gt;

&lt;p&gt;I start by describing what I call a classic retrospective and the biggest risk I encountered with it. Then I describe the structured retrospective I introduced. Finally some tradeoffs of the structured retrospective.&lt;/p&gt;

&lt;p&gt;I gave a 15 minutes talk about this subject at Pivotal Labs in Los Angeles, you can watch it &lt;a href=&quot;https://www.youtube.com/watch?v=-Pw-p6DzvFQ&quot;&gt;here&lt;/a&gt;. If you’re interested I wrote a blog post about &lt;a href=&quot;http://teotti.com/measure-success-of-your-agile-retrospective/&quot;&gt;measuring retrospective success&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;This article is about retrospective for co-located teams&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;the-classic-retrospective&quot;&gt;The classic retrospective&lt;/h2&gt;

&lt;p&gt;If you’re practicing a retrospective it’s very likely that this is the format you’re using.&lt;/p&gt;

&lt;p&gt;The whole team gets in a room.&lt;/p&gt;

&lt;p&gt;Then a random person is picked as the facilitator to ensure the conversations are kept on track and timeboxed.&lt;/p&gt;

&lt;p&gt;Then the whole group starts adding last iteration events to a whiteboard–or an electronic equivalent–with three columns:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;mad&lt;/li&gt;
  &lt;li&gt;sad&lt;/li&gt;
  &lt;li&gt;glad&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;representing the feeling that the event triggered &lt;strong&gt;for that person&lt;/strong&gt;. Multiple variations of this exists–ie. start, stop, continue–but the root activity stays the same.&lt;/p&gt;

&lt;p&gt;After the team is done adding items the facilitator kicks off the retrospective by reviewing the outcome of the last retrospective and then starting timeboxed discussions about each event on the board.&lt;/p&gt;

&lt;p&gt;The facilitator is also asking if there is any “action item” to make that event better. In this retrospective format an action item is often described as an attempt to prevent a negative event from reoccurring.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;p&gt;Sometime the scrum master act as the facilitator. In my experience is very unlikely that the team will recognize the same person pressing for delivery and deadlines as an unbiased facilitator. The result will be that &lt;strong&gt;the retrospective will feel just like a status update meeting&lt;/strong&gt;.&lt;/p&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;pro-of-this-retro&quot;&gt;Pro of this retro&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;It’s really simple to explain to people new to retrospectives because the format is always the same&lt;/li&gt;
  &lt;li&gt;Everybody’s event is very likely to be–perhaps briefly–discussed&lt;/li&gt;
  &lt;li&gt;The facilitator can be a random team member and doesn’t need any special training (not quite true but more on this …)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;cons-of-this-retro&quot;&gt;Cons of this retro&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;A &lt;strong&gt;randomly picked facilitator&lt;/strong&gt; might not have the skills,empathy or willingness to manage arguments. In extreme cases I’ve seen that person &lt;strong&gt;hijack the retrospective making it about a subject of his/her interest&lt;/strong&gt;.&lt;/li&gt;
  &lt;li&gt;Using the same format for months &lt;strong&gt;won’t keep people’s brain engaged&lt;/strong&gt;. It’s the responsibility of a diligent facilitator to do that.&lt;/li&gt;
  &lt;li&gt;The mad, sad, glad–or whatever names you use–is an effective way to collect events but &lt;strong&gt;can’t generate insight of the overarching problems that generates them&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;the-biggest-risk-is&quot;&gt;The biggest risk is…&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;focusing on each event and missing an opportunity to see the overarching root cause.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This is an example based on a real project I was on: a sad face on “slow deployment” and someone starts talking about &lt;em&gt;“how deployments take over a long time and that’s really slow yada yada yada”&lt;/em&gt; so someone comes up with an &lt;strong&gt;“action item”&lt;/strong&gt; to &lt;strong&gt;“investigate deployment speed”&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Then a meh item is &lt;em&gt;“integration with the BAM API is unreliable”&lt;/em&gt; and someone talks about &lt;em&gt;“how 3 out of 5 times BAM is down”&lt;/em&gt; and so someone comes with another &lt;strong&gt;“action item”&lt;/strong&gt; to &lt;strong&gt;“use circuit breaker pattern to tackle BAM unavailability”&lt;/strong&gt;. &lt;/p&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;p&gt;These “action items” seem adequate solutions to each problem but by attempting to individually fix them we obfuscate a possible overarching issue and might miss the root cause that would affect them both.&lt;/p&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;p&gt;In this example the overarching problem–unveiled by the structured retrospective I’ll introduce next–was miscommunication with the BAM team which was also sharing the responsibility of dev-ops deployments. Later in the article I’ll describe the experiment we attempted to fix that.&lt;/p&gt;

&lt;h2 id=&quot;so-whats-the-alternative&quot;&gt;So what’s the alternative?&lt;/h2&gt;

&lt;p&gt;A quick fix would be introducing pattern matching. After the board is filled up the whole team works towards grouping the events. But what about the multiple action items? And the rotating facilitator?&lt;/p&gt;

&lt;p&gt;Let’s be clear: it’s critical for the facilitator to be skilled or willing to learn and experiment. &lt;strong&gt;Facilitation is a very hard job and it’s too often dismissed&lt;/strong&gt;. Ideally the facilitator is external to the team so it doesn’t have a stake in the project.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;p&gt;Have you tried to borrow a facilitator from another team?&lt;/p&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;p&gt;The facilitator should try a structured retrospective. For the sake of this article’s clarity I use the word structured to distinguish it from the mad,sad,glad + action item that I’ll call “classic retrospective”.&lt;/p&gt;

&lt;p&gt;A structured retrospective is divided in 5 parts:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;setting the stage (5 minutes)&lt;/li&gt;
  &lt;li&gt;gather data (20 minutes)&lt;/li&gt;
  &lt;li&gt;generate insight (15 minutes)&lt;/li&gt;
  &lt;li&gt;plan an experiment (10 minutes)&lt;/li&gt;
  &lt;li&gt;close up (10 minutes)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I divided the activities so the retrospective would last 60 minutes. I suggest you schedule it for 75 minutes for padding between activities. If you have iterations longer then one week you might need more time. It’s very unlikely that you can achieve an effective retrospective in less then one hour I used a visual timer so the group can see how much time is left. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/change-your-agile-retrospective-format/timetimer.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;One of the major differences from the “classic retrospective” is the &lt;strong&gt;plan an experiment&lt;/strong&gt; part focused on one experiment rather then a series of “action items”.&lt;/p&gt;

&lt;p&gt;People accustomed to the classic version want to focus the retrospective on their topic so explain that that might not happen and that instead the team will focus on what has higher priority for the group.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;This might upset someone&lt;/strong&gt; using retrospectives to vent their feelings. Make sure that there is still a place for them to do that perhaps before the retrospective.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;p&gt;As the facilitator have you asked your team &lt;strong&gt;what will achieve value for time invested in this retrospective?&lt;/strong&gt;&lt;/p&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;p&gt;As the facilitator have you asked your team &lt;strong&gt;what have we tried before? what happened? what would you like to happen differently?&lt;/strong&gt;&lt;/p&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;p&gt;Make sure the retrospective objective is &lt;strong&gt;defined by the team&lt;/strong&gt;.&lt;/p&gt;

&lt;h3 id=&quot;setting-the-stage&quot;&gt;Setting the stage&lt;/h3&gt;

&lt;p&gt;Asking those two questions is a good way to &lt;em&gt;set the stage&lt;/em&gt; and make sure everybody understands the purpose of the retrospective. One of my favourites exercise is to read &lt;em&gt;Kerth’s prime directive&lt;/em&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;p&gt;Regardless of what we discover, we understand and truly believe that everyone did the best job they could, given what they knew at the time, their skills and abilities, the resources available, and the situation at hand.&lt;/p&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;p&gt;ask for a verbal yes from each member. If there are individuals not willing to set aside opinions–at least for the sake of the retrospective–then you have a bigger problem and you should cancel the retrospective. There might be someone in the room that people don’t feel comfortable around or other group dynamics that need investigation. Have one on one conversations with those individuals that didn’t agree with the directive and investigate what their opinion is.&lt;/p&gt;

&lt;p&gt;The retrospective should be a no naming no blaming activity and the prime directive is a strong and meaningful sentence that encapsulates those values.&lt;/p&gt;

&lt;h4 id=&quot;explorer-shopper-vacationer-prisoner&quot;&gt;Explorer, Shopper, Vacationer, Prisoner&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/change-your-agile-retrospective-format/esvp.png&quot; alt=&quot;ESVP&quot; /&gt;&lt;/p&gt;

&lt;p&gt;A good activity to discover–or track–team interest about the retrospective is ESVP. You will &lt;strong&gt;anonymously&lt;/strong&gt; collect how the participants feel about the retrospective.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/change-your-agile-retrospective-format/explorer.jpg&quot; alt=&quot;the explorer&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At one end the explorer wanting to leave no stone unturned and enthusiastically learn as much as possible.  At the opposite end the prisoner that was forced in to the retrospective.&lt;/p&gt;

&lt;p&gt;If you have a room full of prisoners you should consider cancel the retrospective. Having occasional prisoners is ok–&lt;strong&gt;make sure you acknoledge their presence and thank them for their patience and participation&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Do not ask who’s the prisoner&lt;/strong&gt; if they feel like speaking up they will.&lt;/p&gt;

&lt;p&gt;In one retrospective I facilitated I had some prisoners. I eventually learned–during the closeout step–that the time of the retro was too close to the end of day forcing them to rush catching their train back home.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;p&gt;Make sure you comunicate to the group how long the retrospective will last and commit to end on time.&lt;/p&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;gather-data&quot;&gt;Gather data&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/change-your-agile-retrospective-format/timeline.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I asked the team to collect data during the week on a &lt;a href=&quot;https://www.infoq.com/articles/rising-continuous-retrospective&quot;&gt;continuous timeline&lt;/a&gt; so during retrospective they could read that and &lt;strong&gt;remember&lt;/strong&gt; what happened during that iteration–add new things if they forgot–ask each other questions and be ready for the next step.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;It’s important for the whole team to read and understand what’s on the board.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Some of those events can be color coded at the time of the writing or you can decide to color code during the retrospective. The second option might spark interesting conversations because an event–ie. quick and dirty refactoring–that is sad from the eyes of the author could be a happy for others.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/change-your-agile-retrospective-format/timeline-color-coded.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Other good pieces of data to show at this point are number of delivered stories/points, number of deployments, bug count.&lt;/p&gt;

&lt;p&gt;The timeline should collect events–and hard data–for example: “spent 16 hours fixing the dropdown bug” instead of “we don’t deliver fast enough” which is a personal consideration. Personal consideration and feeling are important and they will be discussed in the next step: generate insight.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;p&gt;Suggestion: If you’re keeping the post-its from the weekly continuous timeline for a longer project retrospective I found it useful to timestamp the iteration week to facilitate the creation of the project timeline:&lt;/p&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/change-your-agile-retrospective-format/timestamped-events.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;generate-insight&quot;&gt;Generate insight&lt;/h3&gt;

&lt;p&gt;Once we have information about what happened on the last iteration the team can start looking for patterns. Ask them to move the events in to groups/topics. As a facilitator make sure the whole team participate.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/change-your-agile-retrospective-format/generate-insight.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;You should now be halfway trough your restrospective and have a handful of overarching topics. Ask the team to vote on each group so the one with highest count will be the focus of the experiment.&lt;/p&gt;

&lt;h4 id=&quot;it-doesnt-always-work&quot;&gt;It doesn’t always work&lt;/h4&gt;

&lt;p&gt;If the group is large or the team has a lot of friction it might be hard to decide a topic to discuss within the time allocated for retro. In that case is good to prepare a list of topics to generate insight on. I like to ask those to individual team members before the retro.
&lt;img src=&quot;http://teotti.com/assets/article_images/change-your-agile-retrospective-format/team-radar.jpg&quot; alt=&quot;team radar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;During team radar people vote from 0 to 10 how well the team perform on a number of topics. Then the conversation starts and the facilitator add notes as people talk about the reason for their votes. This is a direct way to generate insights on specific areas/topics.&lt;/p&gt;

&lt;h3 id=&quot;experiment&quot;&gt;Experiment&lt;/h3&gt;

&lt;p&gt;Once one ovearching topic has been identified it’s time to formalize a measurable experiment to incorporate in the next iteration. I like to stick it to the timeline so everyone can read it.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/change-your-agile-retrospective-format/experiment.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I like the experiment to have the following format:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Hypotesis&lt;/strong&gt;: “a supposition or proposed explanation made on the basis of limited evidence as a starting point for further investigation”.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Experiment&lt;/strong&gt;: “a procedure undertaken to test a hypothesis”&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Measurement&lt;/strong&gt;: having measurements help determine if the experiment was successful or not&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;example one:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Hypotesis: Having two BAM API developers pairing–ideally on site–with the team will help speed up deployments and debug BAM problems.&lt;/li&gt;
  &lt;li&gt;Experiment: Propose to the BAM team manager to have two devs to work next to the team. If not possible use remote desktop sharing with webcams to see each other.&lt;/li&gt;
  &lt;li&gt;Measurement: Count number of times BAM is not operational. How long it takes for BAM to be operational again. How many times BAM developers are pairing on site. How many times BAM developers are pairing remotely.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;example two:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Hypotesis: The team agrees that: 9’oclock is an acceptable standup time and starting standup everyday at the same time regardless of who’s missing.&lt;/li&gt;
  &lt;li&gt;Experiment: Standup starts at 9am everyday with a–weekly–facilitator assigned on the calendar. If the measurement shows low presence reschedule standup at 9.30am. Enrico will create the facilitator calendar for the next 2 months.&lt;/li&gt;
  &lt;li&gt;Measurement: How many times standup starts after 9? How many people are missing the 9’oclock standup.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;closing&quot;&gt;Closing&lt;/h3&gt;

&lt;p&gt;Now is the time to finish the retrospective and there are two activities I like.&lt;/p&gt;

&lt;p&gt;One is to end on a high note with the &lt;strong&gt;apreciation&lt;/strong&gt; activity. This activity is &lt;strong&gt;only for praises&lt;/strong&gt;.  For example: &lt;strong&gt;I apreciate Linda for her hard work commuting everyday to be onsite.&lt;/strong&gt; or &lt;strong&gt;I apreciate David for his honest feedback while discussing code.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;There will be akward silence.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Remind everyone to think back the whole iteration and that even small things should be brough out.&lt;/p&gt;

&lt;p&gt;I facilitate a team where people were offsite and unable to attend the retrospective so I suggested to write the apreciation on a piece of paper and let the product owner delier that once back at the office.&lt;/p&gt;

&lt;p&gt;Another activity is to get retrospective feedback from the group. I’d start with anonymous feedback. This is a great way to make sure you and the group are on the same page.&lt;/p&gt;

&lt;h2 id=&quot;cons-of-a-structured-retrospective&quot;&gt;Cons of a structured retrospective&lt;/h2&gt;

&lt;p&gt;I was told this retrospective format feels like you’re working. It’s true. The facilitator needs to prepare activities and collect data and the group will need to be much more engaged and will feel like they’re working rather then sitting in a status meeting. I think this is good but be prepared.&lt;/p&gt;

&lt;p&gt;If you don’t have a willing facilitator it’s hard to introduce this retrospective format.&lt;/p&gt;

&lt;p&gt;In small teams of 2/3 individuals this format is not very effective. I tried and the folks didn’t see an advantage over the classic format.&lt;/p&gt;

&lt;p&gt;The activities are made for face to face interactions and are much harder–sometime inadeguate–to run with remote folks. With a remote team try run the structured retrospective when the team meets face to face.&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;If your classic retrospective feels like a status meeting I hope you will switch to a structured one and pick some new activities from this article and &lt;a href=&quot;http://www.amazon.com/Agile-Retrospectives-Making-Teams-Great/dp/0977616649&quot;&gt;Derby&amp;amp;Larsen book&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I’d love to hear your experiences and challenges switching from a classic to structured retro in the comments. If you’d rather start a 1:1 conversation feel free to private message me on twitter @agenteo.&lt;/p&gt;
</description>
        <pubDate>Wed, 23 Aug 2017 00:00:00 +0000</pubDate>
        <link>http://teotti.com/change-your-agile-retrospective-format/</link>
        <guid isPermaLink="true">http://teotti.com/change-your-agile-retrospective-format/</guid>
        
        <category>workflow</category>
        
        <category>retrospectives</category>
        
        <category>agile</category>
        
        
      </item>
    
      <item>
        <title>Concourse pipeline for consumer driven tests with Spring boot and Ruby</title>
        <description>&lt;p&gt;This article demonstrates how a &lt;a href=&quot;http://concourse.ci&quot;&gt;Concourse&lt;/a&gt; CI pipeline can run consumer driven tests between two cross language apps: a Java Spring Boot web app and a Ruby Sinatra API. The examples use the &lt;a href=&quot;https://docs.pact.io&quot;&gt;PACT framework&lt;/a&gt; and its &lt;a href=&quot;https://github.com/DiUS/pact-jvm&quot;&gt;jvm&lt;/a&gt; and &lt;a href=&quot;https://github.com/realestate-com-au/pact&quot;&gt;Ruby&lt;/a&gt; implementations. This article assumes basic understanding of pact and how it works so if you want to learn more about it visit &lt;a href=&quot;http://pact.io&quot;&gt;http://pact.io&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;PACT has a broker to share contracts across applications but if your applications ecosystem is already in a pipeline contracts tests can be part of that.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;All of the code is on github&lt;/strong&gt;: the &lt;a href=&quot;https://github.com/agenteo/pact_concourse_pipeline&quot;&gt;pipeline&lt;/a&gt;, the &lt;a href=&quot;https://github.com/agenteo/spring-boot-pact-consumer&quot;&gt;consumer&lt;/a&gt;, the &lt;a href=&quot;https://github.com/agenteo/ruby-sinatra-pact-provider&quot;&gt;provider&lt;/a&gt; and the &lt;a href=&quot;https://github.com/agenteo/pact-repository&quot;&gt;pact repository&lt;/a&gt;. To run the example on your machine you’ll need to fork the repos and update the &lt;code&gt;pipeline.yml&lt;/code&gt; with the new URLs. You’ll also have to specify your Github key when setting the pipeline ie. &lt;code&gt;fly --target travel-inc set-pipeline --config pipeline.yml --pipeline travel-offers --var &quot;pact-repository-key=$(cat your_id_rsa)&quot;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;For the sake of brevity I kept the tech stacks simple: the consumer code is a Spring Boot app using static templates, I used hardcoded provider responses for the Ruby API.&lt;/p&gt;

&lt;p&gt;In this example I will start from a green pipeline and then commit a &lt;a href=&quot;https://github.com/agenteo/spring-boot-pact-consumer/commit/41f4f51d2aa2344a02813f1af99f4e3fe140bb9c&quot;&gt;consumer change&lt;/a&gt; that will break the &lt;a href=&quot;https://github.com/agenteo/ruby-sinatra-pact-provider/commit/e1bebbe59387473cc001d6c8228f8c0b96bae0c1&quot;&gt;provider state&lt;/a&gt;. After &lt;a href=&quot;https://github.com/agenteo/ruby-sinatra-pact-provider/commit/33f657593c8d54c50794dfbf231b82b185b68c0e&quot;&gt;fixing the provider&lt;/a&gt; the pipeline will go back to green.&lt;/p&gt;

&lt;h2 id=&quot;background-about-the-example&quot;&gt;Background about the example&lt;/h2&gt;

&lt;p&gt;This is a simplified example adapted from a real live application.&lt;/p&gt;

&lt;p&gt;The web application &lt;strong&gt;Travel Offers&lt;/strong&gt; displays fabulous travel offers fetched from the tedious legacy &lt;strong&gt;SEAL API&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;The travel offers is a green field app so everybody on the team is excited about using new technologies and want to make sure the API integration is solid.&lt;/p&gt;

&lt;p&gt;Instead the SEAL API is the classic app that nobody wants to work on, 5 years old, lots of &lt;a href=&quot;https://martinfowler.com/bliki/TechnicalDebtQuadrant.html&quot;&gt;inadvertent tech debt&lt;/a&gt; and a long backlog of bugfixes and features.&lt;/p&gt;

&lt;p&gt;When the SEAL API team is asked to add a new endpoint or field by a consumer their approach has been to add all possible fields and then publish a document so the consumer can’t possibly ask for anything else.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Consumer driven test is a refreshing and pragmatic strategy to API design that helps comunication but it will fail miserably if there is no support on the SEAL API team.&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;p&gt;Make sure the SEAL API team is willing to test and honor their contract&lt;/p&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;pipeline-to-the-help&quot;&gt;Pipeline to the help&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://concourse.ci/&quot;&gt;Concourse&lt;/a&gt; is a CI pipeline that helps visualizing the consumer/provider dependency and automating the contract publishing and verification. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/concourse-pipeline-for-consumer-driven-tests-with-spring-boot-and-ruby/pipeline.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;consumer-driven-change&quot;&gt;Consumer driven change&lt;/h2&gt;

&lt;p&gt;The pipeline has a &lt;strong&gt;travel-offers-webapp-consumer-tests&lt;/strong&gt; job that tests the travel offers consumer app interaction with the API provider SEAL API.&lt;/p&gt;

&lt;p&gt;I pushed a &lt;a href=&quot;https://github.com/agenteo/spring-boot-pact-consumer/commit/41f4f51d2aa2344a02813f1af99f4e3fe140bb9c&quot;&gt;consumer change&lt;/a&gt; to add a &lt;code&gt;members_price&lt;/code&gt; on the provider. The pipeline picks up that change and runs the consumer tests.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/concourse-pipeline-for-consumer-driven-tests-with-spring-boot-and-ruby/consumer-pass.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;That consumer test passes and it generates a JSON PACT (&lt;strong&gt;consumer-driven-api-contracts&lt;/strong&gt;) that the pipeline will upload to a &lt;a href=&quot;https://github.com/agenteo/pact-repository/commit/e6ac9c6e3636747ab3270d18f7a683a323d6541b&quot;&gt;contract git repository&lt;/a&gt;. &lt;em&gt;There is only one PACT file in this simplified example&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;The Concourse pipeline will monitor the contract repository. When the new one is published it will run the API provider job (&lt;strong&gt;seal-api-provider-tests&lt;/strong&gt;) and that will fail.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/concourse-pipeline-for-consumer-driven-tests-with-spring-boot-and-ruby/provider-fail.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;provider-update-to-fix-the-pipeline&quot;&gt;Provider update to fix the pipeline&lt;/h2&gt;

&lt;p&gt;The provider tests are broken.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/concourse-pipeline-for-consumer-driven-tests-with-spring-boot-and-ruby/provider-fail.png&quot; alt=&quot;see pact complaining about missing members_price&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;On your workstation you will need to fetch the latest contract repositories to get the failing test.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;I &lt;a href=&quot;https://github.com/agenteo/ruby-sinatra-pact-provider/commit/33f657593c8d54c50794dfbf231b82b185b68c0e&quot;&gt;update the provider&lt;/a&gt; to satisfy the new contract. The pipeline will pickup the provider change and run its tests again returning to a green state.&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;If you want to run consumer driven tests in a highly visible Continuous Integration server Concourse can do that.&lt;/p&gt;

&lt;p&gt;Rather then making the entire test suite fail having a consumer driven dedicated pipeline or jobs can increase the understanding of which parts of your ecosystem are broken and allow an incremental approach to TDD and CI.&lt;/p&gt;
</description>
        <pubDate>Wed, 24 May 2017 00:00:00 +0000</pubDate>
        <link>http://teotti.com/concourse-pipeline-for-consumer-driven-tests-with-spring-boot-and-ruby/</link>
        <guid isPermaLink="true">http://teotti.com/concourse-pipeline-for-consumer-driven-tests-with-spring-boot-and-ruby/</guid>
        
        <category>testing</category>
        
        <category>ruby</category>
        
        <category>java</category>
        
        
      </item>
    
      <item>
        <title>Parallelising iOS UI tests</title>
        <description>&lt;p&gt;This article explains how to run iOS UI tests in parallel on a OSX host running multiple guests OSX virtual machines–the objective is to speed up a time consuming iOS UI test suite. You can find the script, its dependencies and a test project on &lt;a href=&quot;https://github.com/pivotalbeachla/parallelize-tests&quot;&gt;github&lt;/a&gt;. &lt;strong&gt;I really hope to save someone’s hours of time I spent on UI testing parallelization dead ends.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/parallelising-ios-ui-tests/step1.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;tldr&quot;&gt;tldr;&lt;/h3&gt;

&lt;p&gt;Xcode8 has a &lt;code&gt;xcodebuild&lt;/code&gt; option called &lt;code&gt;--only-test&lt;/code&gt; to run single test files–our &lt;a href=&quot;https://github.com/pivotalbeachla/parallelize-tests/blob/master/run.rb&quot;&gt;proof of concept Ruby script&lt;/a&gt; collects the Xcode project test file list and runs them via ssh on multiple virtual machines–legally–running OSX. This script doesn’t allow to distribute test functions across virtual machines even if that is a valid option to &lt;code&gt;--only-test&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/parallelising-ios-ui-tests/step3.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Our &lt;a href=&quot;https://github.com/pivotalbeachla/parallelize-tests&quot;&gt;test project&lt;/a&gt; has around 15 tests–some with sleeps–and it takes around 20 minutes running on a single iMac (16GB ram, 3.5 GHz Intel Core i5 quad core). This script runs them in 7/8 minutes (with 3 virtual machines running on the same iMac). During our tests we confirmed that a shorter 2/3 minutes test suite did not benefit from this virtualization.&lt;/p&gt;

&lt;h2 id=&quot;the-problem&quot;&gt;The problem&lt;/h2&gt;

&lt;p&gt;As a project grows sets of diverse features over months and years its UI tests will increase and so will the suite execution time.&lt;/p&gt;

&lt;p&gt;Apple doesn’t make it easy to parallelise a test run–its xcodebuild has an option to parallelize a build but not the automated tests and its &lt;a href=&quot;https://developer.apple.com/library/content/documentation/IDEs/Conceptual/xcode_guide-continuous_integration/&quot;&gt;xcode server&lt;/a&gt; doesn’t support parallelization at the time of this writing.&lt;/p&gt;

&lt;p&gt;At the time of this writing researching this topic online lead to &lt;strong&gt;a lot&lt;/strong&gt; of dead ends and I felt compelled to write a blog post about our proof of concept solution. Facebook’s &lt;a href=&quot;https://github.com/facebook/xctool&quot;&gt;xctool&lt;/a&gt; list test run &lt;a href=&quot;https://github.com/facebook/xctool#parallelizing-test-runs&quot;&gt;parallelization&lt;/a&gt; but during our tests that was true only for unit and &lt;strong&gt;not for &lt;a href=&quot;https://github.com/facebook/xctool#parallelizing-test-runs&quot;&gt;Apple’s UI tests&lt;/a&gt;&lt;/strong&gt;. Amazon’s &lt;a href=&quot;https://aws.amazon.com/device-farm/&quot;&gt;AWS device farm&lt;/a&gt; allows to spread UI tests over a number of different devices but not to parallelize in order to reduce execution time.&lt;/p&gt;

&lt;p&gt;Running multiple simulators on a single OSX workstation was a dead end. Running multiple physical devices connected to a OSX workstation would allow parallelization but it wasn’t a suitable solution for us.&lt;/p&gt;

&lt;h2 id=&quot;this-proof-of-concept-stack&quot;&gt;This proof of concept stack&lt;/h2&gt;

&lt;p&gt;We will use a mix of open and proprietary tools:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;OSX (duh)&lt;/li&gt;
  &lt;li&gt;OSX server ($19)&lt;/li&gt;
  &lt;li&gt;VMware Fusion ($79.99)&lt;/li&gt;
  &lt;li&gt;Ruby + awesome gems ($0)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; Oracle’s Virtual Box is a free alternative to Fusion but it was giving us a hard time finding the OSX recovery partition to virtualize OSX.&lt;/p&gt;

&lt;p&gt;The setup of the first virtual OSX box is manual–it can then be cloned to increase the size of your virtual boxes test farm. Once the VMs are setup the Ruby script &lt;code&gt;run.rb&lt;/code&gt; will inspect the project on the host, find the test files, distribute them to available guests (virtual machines) and finally collect the test results and logs.&lt;/p&gt;

&lt;p&gt;We’ve used a handful of awesome Ruby gems to orchestrate the parallelization:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/capistrano/sshkit&quot;&gt;sshkit&lt;/a&gt; is a tool to distribute ssh commands&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/CocoaPods/Xcodeproj&quot;&gt;xcodeproj&lt;/a&gt; allows to detect targets and lists of test files&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/ruby-concurrency/concurrent-ruby&quot;&gt;concurrent-ruby-ext&lt;/a&gt; to use thread safe structures for the test list&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;installation&quot;&gt;Installation&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://github.com/pivotalbeachla/parallelize-tests/&quot;&gt;This solution&lt;/a&gt; was developed during research and development as a proof of concept. It’s only been tested on a &lt;a href=&quot;https://github.com/pivotalbeachla/parallelize-tests&quot;&gt;test application&lt;/a&gt;.&lt;/strong&gt; Your milage may vary.&lt;/p&gt;

&lt;p&gt;From now on we will refer to your workstation (or CI server) as the HOST.&lt;/p&gt;

&lt;h3 id=&quot;on-the-host&quot;&gt;On the HOST:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;git clone https://github.com/pivotalbeachla/parallelize-tests.git&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;cd parallelize-tests&lt;/code&gt; and then run &lt;code&gt;bundle&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;install OSX server from the AppStore&lt;/li&gt;
  &lt;li&gt;install VmWare Fusion&lt;/li&gt;
  &lt;li&gt;create a new VmWare Fusion OSX virtual machine–follow the wizard that will create the OS from the HOST recovery disk&lt;/li&gt;
  &lt;li&gt;turn on the virtual machine (refered to as GUEST from now on) and set its name ie. (parallel-ios-tests-1)&lt;/li&gt;
  &lt;li&gt;enable the GUEST ssh access from System Preferences -&amp;gt; Sharing&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;provisioning-guest&quot;&gt;Provisioning GUEST&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;install xcode and necessary simulators&lt;/li&gt;
  &lt;li&gt;enable xcode developer mode&lt;/li&gt;
  &lt;li&gt;install git&lt;/li&gt;
  &lt;li&gt;install SSH certificate to allow git checkout&lt;/li&gt;
  &lt;li&gt;create a PROJECT_DIRECTORY and git clone your project–the project directory will be needed when Running the tests from the HOST&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;cloning-guest-and-enlarge-your-virtual-machines-test-farm&quot;&gt;Cloning GUEST and enlarge your virtual machines test farm&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;turn off the GUEST&lt;/li&gt;
  &lt;li&gt;from VmWare’s menu: Virtual Machine -&amp;gt; Create full clone&lt;/li&gt;
  &lt;li&gt;once the new GUEST is turned on change its name (in the script I used &lt;em&gt;parallel-ios-tests-2&lt;/em&gt; and &lt;em&gt;parallel-ios-tests-3&lt;/em&gt;)&lt;/li&gt;
  &lt;li&gt;repeat this as long as you see your total test time decrease&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;running-the-script&quot;&gt;Running the script&lt;/h2&gt;

&lt;p&gt;You will run the &lt;code&gt;run.rb&lt;/code&gt; script from the HOST. Currently all the variables have to be provided via ENV variables ie.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;
LIST_OF_VMS=&quot;parallel-ios-testbox-1.local parallel-ios-testbox-2.local parallel-ios-testbox-3.local&quot; PROJECT_FILE=UnitTest.xcodeproj SCHEME=UnitTest VM_PROJECT_DIRECTORY=&quot;workspace/parallelize-tests&quot; DESTINATION=&quot;platform=iOS Simulator,name=iPhone 7&quot; ruby run.rb
&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/parallelising-ios-ui-tests/testsInProgress.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The test project name is UnitTest, sorry for the confusion :)&lt;/p&gt;

&lt;p&gt;You should see green dots for a successful test and red F for a fail. In the test project you’ll see all greens and one fail:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/parallelising-ios-ui-tests/running.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;More information–including failures whole &lt;code&gt;xcodebuild&lt;/code&gt; outputs–can be found inside the timestamped logs in the script’s directory ie. ios-parallel-tests-20161010_1026.log.&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;Before this I was thinking virtualizing OSX was hard and illegal but it turned out to be legal, very simple and a great way to distribute iOS UI tests.&lt;/p&gt;

&lt;h2 id=&quot;credits&quot;&gt;Credits&lt;/h2&gt;

&lt;p&gt;Tim Kersey and I paired on this during research and development time at Pivotal Labs in Santa Monica. You can find the code of the proof of concept on &lt;a href=&quot;https://github.com/pivotalbeachla/parallelize-tests&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
</description>
        <pubDate>Tue, 01 Nov 2016 00:00:00 +0000</pubDate>
        <link>http://teotti.com/parallelising-ios-ui-tests/</link>
        <guid isPermaLink="true">http://teotti.com/parallelising-ios-ui-tests/</guid>
        
        <category>testing</category>
        
        <category>ioS</category>
        
        
      </item>
    
      <item>
        <title>Untangle unmaintainable Ruby on Rails controller actions</title>
        <description>&lt;p&gt;This article is an example of how to refactor a Ruby on Rails controller action containing a mix of framework specific instructions–ie. redirect, render, flash–and business logic. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://www.osnews.com/images/comics/wtfm.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This is not a silver bullet that will solve all your problems and suddenly increase your Ruby on Rails application code quality. It is an object oriented approach that can–and should–be used in combination with other patterns.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Evaluating if your problem domain complexity accounts for this approach is probably the hardest bit&lt;/strong&gt; and without experiencing the pain of maintaining a big ball of mud for more then a few months that complexity can be hard to spot. To mitigate that instead of a toy example I will use &lt;strong&gt;a simplified problem adapted from a real life usecase&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;In this example I assume the server to render the view layer.&lt;/p&gt;

&lt;h2 id=&quot;our-feature-set&quot;&gt;Our feature set&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
    &lt;p&gt;A regional representative (rep) access an edit/confirm page to update/confirm his profile&lt;/p&gt;
  &lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;p&gt;A few scenarios can happen within that feature:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;the regional rep submits invalid data and fails to edit/confirm the profile&lt;/li&gt;
  &lt;li&gt;the regional rep successfuly updates the profile&lt;/li&gt;
  &lt;li&gt;the regional rep successfuly updates the profile and uploads a new photo&lt;/li&gt;
  &lt;li&gt;the regional rep used an expired notification link and can’t edit/confirm the profile&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The server side handles rendering the view layer and at some point the controller action code might have looked like this:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;
  &lt;span class=&quot;vi&quot;&gt;@regional_representative&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Contact&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;vi&quot;&gt;@regional_representative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update_attributes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:regional_representative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;redirect_to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rep_profile_show_url&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:edit&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;But after introducing that feature set it looks like this:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;find_access_token&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;present?&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expired?&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;confirm_profile_form&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ConfirmProfileForm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update_params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:regional_representative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confirm_profile_form&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid?&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confirm_profile_form&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;photo_path&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;flash&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:photo_update_notice&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;The new photo will be checked and updated by our staff within 72 hours&amp;quot;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;profile_updater&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ProfileUpdater&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;profile_updater&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regional_representative_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confirm_profile_form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;redirect_to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rep_profile_show_url&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:edit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;locals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Contact&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regional_representative_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confirm_profile_form&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;full_messages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:template&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;rep/shared/expired_token&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Sine 2005 when I started working with Ruby and Rails I rarely saw controllers actions staying in their initial state–&lt;strong&gt;they keep growing as the application evolves you see more actions more private methods and it’s always just another little change. Until…&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://media.giphy.com/media/3R1dpjYOfnzJm/giphy.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;the-code-is-not-that-bad&quot;&gt;The code is not that bad&lt;/h2&gt;

&lt;p&gt;This example controller action code is already implementing some good practices to make it more maintainable and intention revealing.&lt;/p&gt;

&lt;h3 id=&quot;form-object-handling-data-validation&quot;&gt;Form object handling data validation&lt;/h3&gt;

&lt;p&gt;Since the validation rules for a regional representative confirming his profile are specific to that &lt;strong&gt;context&lt;/strong&gt; the code uses a &lt;code&gt;ConfirmProfileForm&lt;/code&gt;–an &lt;code&gt;ActiveModel&lt;/code&gt; that handles validation of a &lt;code&gt;regional_representative&lt;/code&gt; &lt;em&gt;entity&lt;/em&gt; instead of creating a special validation case on the &lt;code&gt;Contact&lt;/code&gt; ActiveRecord object.&lt;/p&gt;

&lt;h3 id=&quot;service-encapsulating-persistence-layer-and-notifications&quot;&gt;Service encapsulating persistence layer and notifications&lt;/h3&gt;

&lt;p&gt;The &lt;code&gt;ProfileUpdater&lt;/code&gt; is a service object that encapsulate the ActiveRecord object update and dispatch emails/sms notifications to the regional representative as well as attaching an updated photo to the admin email–to make the example more manageable I’ve skipped the code handling service faliure.&lt;/p&gt;

&lt;h3 id=&quot;explicit-view-variables&quot;&gt;Explicit view variables&lt;/h3&gt;

&lt;p&gt;The rendering of the view templates explicitly provide local variables instead of having instance variables that as the application grows are difficult to track and leak between partials.&lt;/p&gt;

&lt;p&gt;Most developers are able to see and implement those refactorings and when the leftover logic is minimal it can be kept in the controller action &lt;strong&gt;but in this case logic handling steps 1 to 4 is in that controller action and it’s not very intention revealing because it’s closely coupled with framework behaviour&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;domain-logic-mixed-with-the-framework&quot;&gt;Domain logic mixed with the framework&lt;/h2&gt;

&lt;p&gt;Let’s identify the controller action code that interacts with the Rails framework:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# when a photo is updated&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flash&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:photo_update_notice&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Your photo will be updated by the admin.&amp;quot;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# when profile is successfuly updated--possibly with photo update&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;redirect_to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rep_profile_show_url&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# when profile update fails&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;render&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:edit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;locals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Contact&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regional_representative_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confirm_profile_form&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;full_messages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# when using an expired token&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;render&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:template&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;rep/shared/expired_token&amp;quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Imagine encapsulating all that framework specific behaviour in a single object that delegates to the controller using Ruby’s &lt;a href=&quot;http://ruby-doc.org/stdlib-2.2.1/libdoc/delegate/rdoc/SimpleDelegator.html&quot;&gt;SimpleDelegator&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Rep&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ProfileUpdateResponse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;SimpleDelegator&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;profile_updated&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;redirect_to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rep_profile_show_url&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;profile_updated_and_new_photo&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;profile_updated&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;flash&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:photo_update_notice&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Your photo will be updated by the admin.&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;profile_update_failed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regional_representative&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;full_error_messages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:edit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;locals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regional_representative&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;full_error_messages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;expired_access_token&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:template&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;rep/expired_token&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And pass that object to a &lt;code&gt;ProfileChange&lt;/code&gt; service that encapsulate the business logic and given some user input will interact with the controller:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Rep&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ProfileController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ApplicationController&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;service&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ProfileChange&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;ProfileUpdateResponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;perform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:regional_representative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Let’s look at &lt;code&gt;ProfileChange&lt;/code&gt; internals:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Rep&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ProfileChange&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;vi&quot;&gt;@listener&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;listener&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;perform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;token_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regional_rep_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;token_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# not_expires is an ActiveRecord criteria on AccessToken&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;not_expired&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;update_profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regional_rep_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;vi&quot;&gt;@listener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expired_access_token&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;


    &lt;span class=&quot;kp&quot;&gt;private&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;token_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;AccessToken&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;token_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;permitted_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:rep_confirm_profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update_profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regional_rep_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ConfirmProfileForm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regional_rep_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid?&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;update_valid_profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;regional_rep&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Contact&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find_by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;contact_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;vi&quot;&gt;@listener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;profile_update_failed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regional_rep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;full_messages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update_valid_profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;profile_updater&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ProfileUpdater&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;profile_updater&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;contact_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;photo_path&lt;/span&gt;
        &lt;span class=&quot;vi&quot;&gt;@listener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;profile_updated_and_new_photo&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;vi&quot;&gt;@listener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;profile_updated&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;


  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code&gt;ProfileChange&lt;/code&gt; does its job and interacts with the framework via &lt;code&gt;ProfileUpdateResponse&lt;/code&gt;–when test driving &lt;code&gt;ProfileChange&lt;/code&gt; in isolation the framework behaviour can easily be abstracted away to focus on the core logic. &lt;/p&gt;

&lt;p&gt;If framework abstraction isn’t a concern this same refactor could be done in the controller via private methods except very often a single controller holds logic for multiple actions ending up with a mix of responsabilities and a tangle of private methods and shared state.&lt;/p&gt;

&lt;h2 id=&quot;conclusions&quot;&gt;Conclusions&lt;/h2&gt;

&lt;p&gt;In this scenario moving code out of the controller action in to this layer of abstraction untangles framework and domain logic making the profile change intent explicit–in simpler cases this abstraction could just get in the way and leaving the whole logic in the controller action is adequate. This separation concept is based on &lt;a href=&quot;http://alistair.cockburn.us/Hexagonal+architecture&quot;&gt;Ports &amp;amp; Adapters / Hexagonal Architecuture&lt;/a&gt; by Alistair Cockburn.&lt;/p&gt;

&lt;h3 id=&quot;bigger-picture&quot;&gt;Bigger picture&lt;/h3&gt;

&lt;p&gt;Our fictional organization portal operates other contexts:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;a customer can view products and contact a regional representative for support&lt;/li&gt;
  &lt;li&gt;an administrator can manage products and regional representative&lt;/li&gt;
  &lt;li&gt;a regional representative can confirm and manage their profile&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;This example–even after the refactor–is part of &lt;strong&gt;one boundary&lt;/strong&gt;–I’ve left the &lt;code&gt;Rep&lt;/code&gt; module to indicate that–but as the application evolves those three operational contexts will have cross boundary dependencies that this approach doesn’t highlight but it’s easy to move this approach in a &lt;a href=&quot;http://teotti.com/component-based-rails-architecture-primer/&quot;&gt;component based&lt;/a&gt; with Ruby Gems and Rails engines.&lt;/p&gt;
</description>
        <pubDate>Tue, 20 Sep 2016 00:00:00 +0000</pubDate>
        <link>http://teotti.com/untangle-unmaintainable-rails-controller-actions/</link>
        <guid isPermaLink="true">http://teotti.com/untangle-unmaintainable-rails-controller-actions/</guid>
        
        <category>ruby</category>
        
        <category>rails</category>
        
        <category>rails4</category>
        
        <category>architecture</category>
        
        
      </item>
    
      <item>
        <title>Simplelenium with Google Chrome</title>
        <description>&lt;p&gt;This is a very quick post to clarify a way to override the default Simplelenium browser.&lt;/p&gt;

&lt;p&gt;By default it’s PhantomJS and Simplelenium documentation says you need to set a &lt;code&gt;-Dbrowse=chrome&lt;/code&gt; to switch to Chrome. If you’re running your tests via an IDE you can set that in its configuration but CI would need the same configuration instead I used the &lt;code&gt;System.setProperty&lt;/code&gt; in my test like this:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;nd&quot;&gt;@Before&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;executedBeforeEach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setProperty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;browser&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;chrome&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Here’s the full integration test code:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shamelessrecruiter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;web&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;net.codestory.simplelenium.DomElement&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;net.codestory.simplelenium.PageObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.junit.Before&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.junit.Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;net.codestory.simplelenium.SeleniumTest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.junit.Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.junit.runner.RunWith&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.boot.test.SpringApplicationConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.boot.test.WebIntegrationTest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.test.context.junit4.SpringJUnit4ClassRunner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@RunWith&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SpringJUnit4ClassRunner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@SpringApplicationConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ShamelessrecruiterApplication&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@WebIntegrationTest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;server.port:9000&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IntegrationTest&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SeleniumTest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;ReportRecruiterPage&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reportRecruiterPage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getDefaultBaseUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;http://localhost:9000&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Before&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;executedBeforeEach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setProperty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;browser&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;chrome&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;reportAnnoyingRecruiter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;goTo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reportRecruiterPage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reportRecruiterPage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;shouldDisplayWelcomeMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reportRecruiterPage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;shouldDisplayReportForm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reportRecruiterPage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fillInReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Ajeje Brazu&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;ajeje@bra.zu&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                                         &lt;span class=&quot;s&quot;&gt;&amp;quot;Dear candidate, I have the perfect opportunity for you...&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reportRecruiterPage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;submitReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reportRecruiterPage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;shouldDisplaySuccessMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;goTo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reportRecruiterPage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reportRecruiterPage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fillInInvalidReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Ajeje Brazu&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;ajeje bra.zu&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&amp;quot;Dear candidate, I have the perfect opportunity for you...&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reportRecruiterPage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;submitReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reportRecruiterPage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;shouldDisplayValidationErrorMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reportRecruiterPage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;shouldFillFormWithRejectedReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Ajeje Brazu&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;ajeje bra.zu&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&amp;quot;Dear candidate, I have the perfect opportunity for you...&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ReportRecruiterPage&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PageObject&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;DomElement&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;DomElement&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nameField&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;input#name&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;DomElement&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emailField&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;input#email&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;DomElement&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;messageField&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;textarea#message&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;DomElement&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;submitButton&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;input#submitReport&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;shouldDisplayWelcomeMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;should&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;contain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Welcome to ShamelessRecruiter&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;shouldDisplayReportForm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;nameField&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;should&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;haveSize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;emailField&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;should&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;haveSize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;messageField&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;should&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;haveSize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fillInReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;nameField&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;emailField&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;messageField&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fillInInvalidReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;fillInReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;submitReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;submitButton&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;submit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;shouldDisplaySuccessMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;should&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;contain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Thanks for reporting a shameless recruiter&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;shouldDisplayValidationErrorMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;should&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;contain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;not a well-formed email address&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;shouldFillFormWithRejectedReport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;nameField&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;equalTo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;emailField&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;equalTo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;messageField&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;equalTo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

</description>
        <pubDate>Fri, 03 Jun 2016 00:00:00 +0000</pubDate>
        <link>http://teotti.com/simplelenium-with-chrome/</link>
        <guid isPermaLink="true">http://teotti.com/simplelenium-with-chrome/</guid>
        
        <category>java</category>
        
        <category>testing</category>
        
        
      </item>
    
      <item>
        <title>Thinking Sphinx search one model with two indices with static attributes</title>
        <description>&lt;p&gt;In this short article I describe how to use Sphinx and Thinking Sphinx (v3) in a Ruby on Rails application to index the same ActiveRecord model with separate criterias using two indices.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;This article is not an intruduction on the open source search engine &lt;a href=&quot;http://sphinxsearch.com/&quot;&gt;Sphinx&lt;/a&gt; and its Ruby library &lt;a href=&quot;http://freelancing-gods.com/thinking-sphinx/&quot;&gt;ThinkingSphinx&lt;/a&gt; but rather how to solve a problem I faced multiple times and not very well documented online.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;I will use a simplified example adapted from a real life application.&lt;/strong&gt; A company has a web portal where users can view product representatives details. The company has a mangement console where admins can update the product representatives information. Both need to search the representatives data stored in a relational database table–and loaded in a Contact ActiveRecord object–but with different criterias.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://teotti.com/assets/article_images/thinking-sphinx-search-one-model-with-two-indices-with-static-attributes/diagram.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;To make this example manageable I am defining only one criteria different between admin and user search: &lt;strong&gt;A user can’t see a contact that isn’t active but an admin can&lt;/strong&gt;. You already know real life applications aren’t that simple–in real life there are likely a multitude of criterias different between admin and user search and this solution works there.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# /app/indices/contact_index.rb&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;ThinkingSphinx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:contact&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:with&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:active_record&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;indexes&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:first_name&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;indexes&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:last_name&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;indexes&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:phone_number&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;active = true&amp;quot;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# simplified condition to make the example manageable&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;has&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;false&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:user_view_only&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:boolean&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# /app/indices/admin_contact_index.rb&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;ThinkingSphinx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:contact&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;admin_contact&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:with&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:active_record&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;indexes&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:first_name&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;indexes&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:last_name&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;has&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:admin_view_only&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:boolean&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The &lt;em&gt;admin_contact&lt;/em&gt; is a separate index used for admin search only but by default searching on &lt;code&gt;Contact.search&lt;/code&gt; or doing an application wide search via &lt;code&gt;ThinkingSphinx.search&lt;/code&gt; would use both the &lt;code&gt;admin_contact_index.rb&lt;/code&gt; and &lt;code&gt;admin_contact.rb&lt;/code&gt; indexes–that is why I leverage the &lt;strong&gt;admin_view_only&lt;/strong&gt; static attribute to ignore the user view index. For example:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Contact&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;first_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Enrico&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;last_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Teotti&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;active&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Contact&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;first_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Enrico&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;last_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Piovani&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;active&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# reindex Sphinx on console with rake ts:index&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;ThinkingSphinx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Enrico&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;admin_view_only&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# returns Contact entries for admin only, ignoring the filter on active flag&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# set on regular index. Given the above data you will get both Piovani and&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Teotti back.&lt;/span&gt;
 
&lt;span class=&quot;no&quot;&gt;ThinkingSphinx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Enrico&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;user_view_only&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Only Piovani will come back because of the active filter.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;conclusions&quot;&gt;Conclusions&lt;/h2&gt;

&lt;p&gt;I think one disadvantage of this solution is to add an attribute to all non admin indexes to ensure they don’t conflict and also a second index increasing file size and potentially indexing time.&lt;/p&gt;

&lt;p&gt;The advantage is delegating to Sphinx the search rather then having specific search parameters set on search calls for each application portion–also this strategy can be shared by the other indices that need different search criteria between user view and admin.&lt;/p&gt;

&lt;p&gt;The described condition alone doesn’t justify the use of Sphinx or this strategy but in a real evolving application that is rarely the only condition that search runs on–this static attribute strategy has been a good fit when implementing search segregation.&lt;/p&gt;
</description>
        <pubDate>Tue, 17 May 2016 00:00:00 +0000</pubDate>
        <link>http://teotti.com/thinking-sphinx-search-one-model-with-two-indices-with-static-attributes/</link>
        <guid isPermaLink="true">http://teotti.com/thinking-sphinx-search-one-model-with-two-indices-with-static-attributes/</guid>
        
        <category>ruby</category>
        
        <category>rails</category>
        
        <category>search</category>
        
        
      </item>
    
  </channel>
</rss>
